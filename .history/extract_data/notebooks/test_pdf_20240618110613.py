# Open the PDF document
output_pdf_path = "results.pdf"

from PIL import Image
import pymupdf
import io

# Coordinates from the PNG image
png_x0, png_y0, png_x1, png_y1 = 0, 274, 2550, 788

# Open the PDF document
pdf_path = "../pdf/baldwing-catalog-test.pdf"
doc = pymupdf.open(pdf_path)
page = doc[0]


# Get page height for coordinate transformation
page_height = page.rect.height

# Convert from pixels to points (assuming 72 DPI for PDF)
pdf_x0 = png_x0 * 72 / 300  # Adjust DPI if necessary
pdf_x1 = png_x1 * 72 / 300
pdf_y0 = png_y0 * 72 / 300
pdf_y1 = png_y1 * 72 / 300

default_mediabox = page.mediabox

# Create a PyMuPDF Rect object with PDF coordinates
pdf_rect = pymupdf.Rect(pdf_x0, pdf_y0, pdf_x1, pdf_y1)


print(pdf_rect)

text = page.get_text("dict", clip=pdf_rect, sort=True)

image = "b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x02\x00\x00\xa6\x00\xa4\x00\x00\xff\xee\x00\x0eAdobe\x00d\x80\x00\x00\x00\x01\xff\xdb\x00\x84\x00\x0c\x08\x08\x08\x08\x08\x0c\x08\x08\x0c\x10\x0b\x0b\x0b\x10\x14\x0e\r\r\x0e\x14\x18\x12\x13\x13\x13\x12\x18\x14\x12\x14\x14\x14\x14\x12\x14\x14\x1b\x1e\x1e\x1e\x1b\x14$\'\'\'\'$25552;;;;;;;;;;\x01\r\n\n\x0c\n\x0c\x0e\x0c\x0c\x0e\x11\x0e\x0e\x0e\x11\x14\x0f\x0f\x0f\x0f\x14\x14\x10\x11\x12\x11\x10\x14\x14\x13\x14\x15\x15\x14\x13\x14\x15\x15\x15\x15\x15\x15\x15\x1a\x1a\x1a\x1a\x1a\x1a\x1e\x1e\x1e\x1e\x1e####\'\'\',,,\xff\xc0\x00\x11\x08\x00\xa4\x00\xa6\x03\x01"\x00\x02\x11\x01\x03\x11\x01\xff\xc4\x01B\x00\x00\x01\x05\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x03\x00\x01\x02\x04\x05\x06\x07\x08\t\n\x0b\x01\x00\x01\x05\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x10\x00\x01\x04\x01\x03\x02\x04\x02\x05\x07\x06\x08\x05\x03\x0c3\x01\x00\x02\x11\x03\x04!\x121\x05AQa\x13"q\x812\x06\x14\x91\xa1\xb1B#$\x15R\xc1b34r\x82\xd1C\x07%\x92S\xf0\xe1\xf1cs5\x16\xa2\xb2\x83&D\x93TdE\xc2\xa3t6\x17\xd2U\xe2e\xf2\xb3\x84\xc3\xd3u\xe3\xf3F\'\x94\xa4\x85\xb4\x95\xc4\xd4\xe4\xf4\xa5\xb5\xc5\xd5\xe5\xf5Vfv\x86\x96\xa6\xb6\xc6\xd6\xe6\xf67GWgw\x87\x97\xa7\xb7\xc7\xd7\xe7\xf7\x11\x00\x02\x02\x01\x02\x04\x04\x03\x04\x05\x06\x07\x07\x06\x02;\x01\x00\x02\x11\x03!1\x12\x04AQaq"\x13\x052\x81\x91\x14\xa1\xb1B#\xc1R\xd1\xf03$b\xe1r\x82\x92CS\x15cs4\xf1%\x06\x16\xa2\xb2\x83\x07&5\xc2\xd2D\x93T\xa3\x17dEU6te\xe2\xf2\xb3\x84\xc3\xd3u\xe3\xf3F\x94\xa4\x85\xb4\x95\xc4\xd4\xe4\xf4\xa5\xb5\xc5\xd5\xe5\xf5Vfv\x86\x96\xa6\xb6\xc6\xd6\xe6\xf6\'7GWgw\x87\x97\xa7\xb7\xc7\xd7\xe7\xf7\xff\xda\x00\x0c\x03\x01\x00\x02\x11\x03\x11\x00?\x00\xf5T\x92I%)$\x92IJI$\x92R\x92Q}\x8c\xad\xbb\xacph\xf1&\x15+\xba\xc6=zT\xd7X|\xb4\x1f\x8aV\xaao\xa4\xb0\xad\xebY\x8e\x9fI\x8c`\xf8\x17\x7fr\xa5oW\xea\xee\xfej\xd9>\x15\xd6\x1c\x7f\x00\xe48\x82h\xbdRK\x91\x1dC\xebo\xd2\xa9\xaex\xe6,\xa3\xfb\x83J#>\xb2}b\xc6\xd7?\xa5\x1b\x99\xdd\xd4nc\xbf\xcd~\xe1\xf8\xa5aT\xf5I,\x8e\x9f\xf5\xa3\xa5u\x07\x8a\x03\xdd\x8d\x90\xed\x05\x19#\xd3y?\xc9\x9d\x1d\xf2+]\x14)$\x92IJI$\x92R\x92I$\x94\xa4\x92I%)$\x92IJI%\x17\xbd\xb5\xb4\xbd\xe6\x1a5$\xa4\xa5\xc9\x8dJ\xa1\x95\xd5\x1a\xd9f<8\xf7q\xe0|\x15\\\xcc\xe7\xe4\x12\xc6Kj\xfcO\xc5b[\xd5X\xe6\xbc\xe39\xad\xa6\xb2E\x99O\xd5\x80\x8eEc\xf3\xdd\xf8&\x99v\\"\xe8\xe4d\x12C\xf2\x1eIv\x8d\x1a\x92O\x83\x1a5?%C7\xaa\xe1\xe1\xe9{\xc5n\xfd\xc1\x0f\xb3\xfc\xd0v\xb7\xe6O\xc1b[\xd4:\x97Qq\xa7\xa3\xb1\xec\xae\xcfk\xf2\xac\xfer\xc1\xfdo\x0f\xe4\xb7Eg\x0f\xea\xc5X\x8c\xfbOT\xc9m^.q\x82~\t\xb6\xba\x99\xbf\xafd\xd9\xfd\x17\x15\xad\x1d\xac\xc9;\x8f\xc9\x87O\xb9\xa9\xc6O\xd6|\xa1\x15\xe4\xbd\x8d\xec*f\xd1\xff\x00}Wq\xb2:=\x047\xa7\xe3Y\x94\xff\x00\xdf\x8d\xa3\xefw\xf7-|{\xba\x85\x82}\n\xa8i\xecIq\xfe\tQ\xee\x8b\xf0y\xa3\xd3~\xb5;\xdc3o\x07\xcd\xc0\x7f\x14\xd1\xf5\xdf\x0f\xdd^K\xac\x03\xb3\xe1\xdf\xc1vl\xf5\xc8\xf7\x16\xcf\x90D\xda\x1c=\xc0\x1f\x924\xabx\xa7}g\xea,o\xa1\xf5\x87\xa5\xd7\x95W\x0eph\x9f\x8e\xb2\xb7\xfa\x1f\\\xe9\xb9m\x15\xf4\xdc\x92@\xff\x00\xb4\x99\x04\xeeo\x93\x1c\xefw\xdf+B\xfe\x9fE\xed!\xcd\x05s][\xea\x95N>\xbe\x1c\xd3kuk\x99\xa4\x1f\x92VB\xa8\x17\xb3\xae\xe6Y h\xe1\xcbN\x84".\x13\xa5\xfdd\xcb\xc1\xc8gM\xeb\xd2\xd7\x03\x14\xe5\xff\x00\xe4\x97i\x8d\x90.l\x18\xde\x04\xe9\xc1\x1f\xbc\xdf$\xe0mi\x14\x9d$\x92E\nI$\x92R\x92I$\x94\xa4\x92I%,H\x02N\x80r\xb1\xf3r\xceC\xb63J\xdb\xc7\x99\xf1Vz\x96L\x0f\xb3\xb0\xf3\xab\xfe\x1e\x0b\x94\xeb\xddGl\xf4\xea\x9f\xe9\x8d\x9b\xf2\xad\x1c\xd7Y\xfc\xc1\xfc\xa7\xfeD\xd2z.\x03\xaa\x0e\xab\xd5+\xc9\xde\xc1af\x05Gm\xb64\xc3\xafx\xe6\xba\xcf\xee\x8e\xe5W\xc7\xc7wP{\x1f\x96\xd0\xcaX?C\x8a4c\x1a;\xd9\xfd\xdfz\xa1\x88\xd7u\x0b[yh\xaf\x1a\x91\x14VtkZ\xdf\xce(y\xfdP\xdf8\xb8d\xb6\x8e\x1c\xfe\r\x87\xf87\xc97u\xdb:\xf9=~\xacO\xd5\xfacE\x96\r\r\xa7\xe8\x8f&\x84N\x9d\xd2r\xba\xad\xad\xca\xcf{\x9f=\xdd\xa9>Mj\xab\xd0\xfaK\x0bF^T6\xb0t\xdd\xf9\xc7\xe1\xddt\xf5e9\xc3\xd2\xc4li\x05\xe7\xc1#A\x1b\xb6k\xa3\x07\xa6\xd6$5\x9aw\xe4\xa0;\xeb\x16\x03\x0e\xd6\x92~\x03\xfd\xcb\x9d\xeb\xddI\xed\x7f\xd91\xdd\xea\\t{\xa7F\xa1`b\xd2\xc6z\xb9\x0eu\xcf\xe7\xc1\xa3\xe6\xe8K\x894\xf5\r\xfa\xc1\x84\xedN\xe1\xf1\n\xdd\x1dO\x12\xef\xa0\xf9\xf9\xaelX\xd2"\xa6\xb7\xe0\xd2\xc3\xf9\x1c\x82\xff\x00X\xbfh\xac\xcf\xc3i\x1f\x91\x0b*\xa0\xf6\x8d\xb9\x8e\xe0\xcf\x9a\x99\xda\xf1\x0e\xfb\xd7/\x87\x91\x9fDz\x83s<\x0f!\\\xfd\xb8\xeaL\x1a\xa4x\x17G\xfd\xf4\xa2\x8a_\xaetJ3\xe8s\\\xddy\x07\xc3\xe0\xb2\xbe\xaeuL\x9c,\x9f\xd8\xb9\xce\xfd%z\xe2\xd8\xee\xe3\xf7\t\xf3\x0bS\xfeq\xd4\xe1\xb5\xf8\xee\x8f\x16\xbc\x1f\xca\x1a\xb0\xba\xfd\x98\x99Mn^)uY\x14\x9d\xed\xdc\xd8:x\x11#\xf1EO\x7fM\xad\xba\xb1ct\x9eA\xe4\x1e\xe1\x11a\xfd[\xeac?\x19\x96\xf7\xb4{\x87\x85\x8c\xd1\xdfx[\x89\xe0\xda\xc2)I$\x92JRI$\x92\x94\xa1u\x82\xaa\xddc\xbf4)\xaa\x1dN\xdd\x19H\xef\xee?\xc1\x02iCW\x1f\xa9g\xb7\x0f\x1a\xdc\xdb}\xce\x1fE\xbf\xbc\xf3\xa3[\xf7\xae\x1f#\xd5\xcc\xca\xfb\x0b\x9d\xb9\xc5\xde\xbem\x83\xbb\xcf\xe6\xfc\xb8\x0bk\xeb?Pmy\x1bI\xfd\x1e\x0b=W\x0f\x1b\x9f\xa5c\xe45Xx\xe1\xf8=<\xe4?\xfaNQ\xdeI\xe4\x17q\xf7\rS\x0fe\xec\xba\x8eXk\x7fg\xe3\xfbk\x10-#\xbc~g\xc0wQ\xe98m\xc9\xb8\xbe\xdd(\xa7\xdc\xf3\xe3\xe0\xd1\xf1Tb\x1b\xdc\x93\xf7\xad\xbc`\xdc\\@\x1ca\xad\xf7?\xf9O<\xfd\xdc"t\n\x1a\x96\xfd\xb9\x80\x16\xba\xc2\x18\xd6\x88c\x07\rj\xa9\x9d\xf5\xa9\xac\xc78\xf8\x8f\xf4j\x1a>\xef\xcey\xfd\xd6\x00\xb9\xce\xa3\xd4\xdf\x93k\xaaa;G\xd2#\xf0hA\xa5\x955\xed\xb70\xcbZ\'o`<\x13j\xf5K\xb3\xd3\xb1:\x87W\xddu\r\x18\xb8\xad\xfay7j\xef\xee\xfb\xbe\xf5\xab\xd3i\xe8\xb5\xdf\xb4UgR\xb1\x84M\x96\x9fd\xf9\x03+\x1b\x1b\xaaf\xfda\xbd\xbd/\xa57n=P,\xb0\x08\xae\xb1\xf0\x1c\xb9ut\xd1\x87\xd11\x80\x11\xb8\x0fs\x8f$\xa3\xaf\x92\xb4t\xd9_\xdaZ)\xaf\x1a\x9cz\xdd\xa1c\x18\xd2\xe3\xf3\xda\xb4qz-U\xb4o\x01\xa0p\xd1\xe0\xaa\xf4~\xa3\x86h\xfbK\xdc\x04\xf7(]K\xeb~=\x12\xcca\xb9\xde\'\xfb\x91\x1e+O\x83\xadf\x0e\rl\x9b\x00h\x1d\xc9\\\x87\xd67b:\xb7\xb3\r\xf1`\xfa$x\xa8\xfd\xab\xabu\xcb#\xdd\xb0\xf6\x13\xc2\xd5\xc2\xfa\xb7c\x06\xe7\xd6\xd2\xef\x1b\x0f\xf0l\xa4\xa7\x8c\xc5\xc6\xea\xf6\x90[\xbb\xee+g\x1b\xa6\xf5x\xf7\xb7p\xf3\x0b\xae\xa3\xa7\xddV\x8d}\r\xf2md\xfe&\xc5i\xb5\xe57\xf3\xaax\xf0\xd8[\xff\x00~))\xe4\xf1\xb1\xf3\xfa}\x82\xfcf\x9a\\\x0e\xe76%\x8e?\xcao\xf1\x0b\xa5\xe9}j\x9c\xe3\xf6{[\xe8e\x01&\xb2ttrX{\xfeUg{F\x97W\xb7\xccj\x15<\xfe\x8f\x8f\x96\xcfR\x83\xe9\xda\xdfs\x1e\xdd!\xc3\x82\x0fdA\xa5\x11n\xb2K3\xa4\xf5+//\xc2\xcd\x1br\xe8\xfa]\x85\x8d\xe3x\xfe+M9j\x92I$\x94\xa5\x8d\x9dh7\xd8\xf7\x1fk9>\x01\xa3U\xb0Lj\xb9N\xbdy\xab\xa5e\xda\x0f\xb9\xcd,\x07\xce\xc2\x1b\xfcSd\x98\xbcGQ\xb5\xfdC*\x8a\x1eu\xcd\xb9\xd96\xff\x00\xc5\xb4\xfbG\xdc\x97P\xb7\xd6\xc9\xd8>\x8d@\x08\xf3:\xfeHP\xc3>\xb7]\xcbw\xe6\xe2S^;|\x8b\xbe\x92\x11\x7f\xa8]g\xef\xb8\xbb\xe4P\x1b\xae;*\xa6\x9b/c\x072#\xe2\x8b\xf5\x838b\xd41\xab:\xb4k\xf1O\xd2F\xec\xd0\xf3\xc3\x1a\xe7\xfd\xdf\xefX\xbdJ\xd3\x93\xd4F\xee\x0b\xcb\x8f\xc1\xbc u*\x1b2\xc6\xa8WQ\xba\xddcS\xe6\xe2\xa9l\xcc\xeb}B\xbe\x99\x87\xf4\xed>\xf7\x0e\x1a\xde\xe7\xe4\xadu[\xdb\x8f\x8c\x1a\xd3\x00k\xf3\xe0.\xbb\xfc^\xfd^\x188\'\xaa\xe5622\xbd\xc2yk?4#\xfb\x15\xfb]\x9e\x93\xd2p\xbe\xaet\xc6\xd1P\x03`\x97\xb8\xf2\xe3\xdc\x95\xcbu\xce\xb1fm\xe6\xba\xcc0\x1e\xcb[\xebOW\xd3\xec\xb4\x9f\x8c.Y\x8c\xd7s\xbe:\xa4\x10]\x1a\xf3\xee\xae\x81Hv\x80|\x82\xdf\xe8\xdd\r\x8e\xa0un\xb3g\xd9\xf1~\x93w\xe8_\xf0\xee\xa9t\xae\x9d\x89\x81\x8a\xce\xb9\xd6\x9b\xb9\xa7\\<3\xcd\xa4p\xf7\x8f\xdd[XX9=q\xed\xeb\x1d|\xc60\xd7\x1f\x10h\xd2;\x12<?*Jt0\xfa\x86^s}\x1f\xab\xd8\xcd\xc7\xc4n\x9fl\xbcCL~\xe3;\xab\xc2\x9c\\q\xbf;&\xcc\xcbG&\xd7C>U\xb6\x1a\xb2\xba\x9f\xd6\x03SE\x18,\xe3\xda\xd6\xb4@\x11\xd8B\xc1\xb3\x17\xacu37\xdaX\xd3\xf9\xadI/ag\xd6>\x9b\x8f\xed\x0f\xad\x91\xd8\x10\x12\xab\xeb>\x05\xa6\x1bk\x0f\xcc.7\xfeh\x97j\xe7\xb8\x95W#\xea\xad\xd5kS\xb5\x1f$\x95\xf4}.\xae\xa1E\xe3B\x0c\xa9}\x1f}G\xe2;\x15\xe54g\xf5~\x8bh\x05\xcesA\xfa.\x92\x08]\xafA\xfa\xc7OQ\xack\xb6\xc1\xa3\x9ay\t)\xd2\xeau=\xdb:\x96&\x998\xc7t~\xf0\xfc\xe6\x9f"\x16\xb6.Eyx\xf5\xe4\xd5\xf4,hp\xf9\xf6T\x1c\xf1;\xc7\x07G\x0f%\x1e\x88\xff\x00B\xdc\x9c\x03\xf4X\xefZ\xaf\xea\xd9\xc8\xfb\xd1\x89D\x9dd\x92I9k\x17\xfd\x13\xf0+\x8d\xfa\xce\x7f\xc9mg\xef\xdfSO\xdf?\xc1vdH\x85\xc5\xfdi\x11\xd3\x98O\xe6d\xd5?y\t\xb2\xe8\xba/\x11\xd2_6u{\xfb\xbb&\xc1\xfecJ\x83t\xa8\x0f\xe4\xa7\xe8\xcd\x81\xd5j\xee2o\xfcZ\xe5\x00\xef\xd1\xfc\x90\n-\xce\x94a\xf9.\xf0\xa4G\xcd\xdf\xec\\\xfb\xbd\xf9\xe4\x1f\x08\xfcV\xf7Nt:\xf1\xfb\xd5~GO\xf1\\\xe5\x8e\xdby\xbb\xb0\xd7\xfc\xd7\x07\x1f\xc1\x0e\xa9\xe8\xdd\xa7\xa7\x9e\xad\xd5\xf1p\x08%\x8e\xb5\xa6\xc8\xfd\xd6\xcb\x8a\xf4\xee\xa5s:wO!\x90\xd0\xd6\xc3W5\xf5\'\x05\x96\xf5\x0bs\xa2v3h>n\xd5Z\xfa\xe5\x9aC\x9b\x8a\xd3\xf1\x08\xa9\xe6\xaf\xb1\xd97\xba\xd7\x19\x92\xb4\xfa\x17O\xc7\xc8\xbd\xf99\xbf\xd0\xf0\xdb\xea\xdd<9\xdf\x99_\xcc\xac\xda\xdb\r\x9e\x7f\x8a\xd9\xcc\x0e\xc6\xc6\xc7\xe8\x94\xea\xf9\x16\xe4\xc7\xe7\\\xfe\x1b\xfd\x90a\x147\xfa]6}b\xea\x8f\xea=@~\xad\x8f\x11_\xe6i\xf4+\x1e^+[\xa8f>\xf7\xfaL0\xc1\xa0\x03\xf2&eM\xe9]>\xac\x1a\xbe\x98\x1e\xf2?9\xee\xfaE>&1$\x17ryA,p\xfap{\xb7\x11$\xf7[4`0\x0e\x14\x1d~\'O\xa0\xe4e<W[{\x9e\xfeC\xcdR\xc7\xfa\xd9fu\xe6\x9e\x93\x86nk>\x9d\xd6\xb81\x8c\x07\xbb\x8e\xb0\x92\x9d\x9f\xb1\x08\xd0*\xd7\xe17Y\x1f5?\xf9\xc1\xd3\xe8hn^Em\x7f\xe7l$\xb4\x1f\x89\n\xc0\xca\xc5\xcb\xa7\xd5\xc7\xb1\xb60\xf7i\x90\x92\x9ec\xaat\xaa\xafc\x9a\xe6\xfc\n\xe3\xa6\xfe\x8b\xd4[c\t\x01\xae\xd7\xc0\x85\xe9\x19L\x04\x11\xf7.G\xeb>\x13]O\xae\xd1\xab9\xf8$\x14^\xab\x03-\xb98\xac\xb1\xa6C\x80(\xb8\xae\xd9\xd5\xb1\xdc?\xc2\xb1\xf5\x1f\x97\xbc~E\xcd\xfdO\xcas\xf0M.3\xe98\xb3\xe4u\x0b~\x97Nn\x1b\xbb\x8bH\xff\x00\xa2\xe0\x90\xdd]\x1e\x89$\x92OX\xa5\xc9\xfdn\xa0\xfe\xcd\xcc\r\x1f\xcd\x96\xdc?\xb2\xe0\xef\xc8\xba\xc5\x97\xd6\xb1\x1b}$8{mi\xa9\xff\x00\x07\x08BI\x1b\xbeU\x81\x15u\x9e\xa1I\xd1\xb7=\x97\x8f\x85\x8d\x83\xfcUR\re\xd5;\x96\x92\xd3\xf2V\xad\xa9\xf8\xd9\xd4[`\x874?\n\xef\xebTIg\xe1*\x1dR\xa3VG\xaa\x07\xb6\xe1\xbe|\xfb\xa6\x84\xaf\x82\xfd\xb6\x82| \xfc\x0f+/+\x17\xd2\xcb~<h\x0e\xe6y\x83\xdb\xeeV\xa8\xb4\xb1\xe0\xf8\x15g\xa9cz\xf5\xb3"\xaf\xa4\xd1->#\xc1"\x90\xf5?\xe2\xeb\x1d\xec\xe9\x0f}\x9a\xb8\xda\xe6\xcf\x8bY\xa3V\x07\xd6+\xcd\xfd^\xd1\xce\xd3\x0b\xab\xfa\x88\xf0\xfe\x88\x1d\x10}W\x82<\xd7\x19\xd4\x0c\xf5l\x92\x7f\xd2;\xf2\xa4\x14[].\xb6;6\xa7X&\xbaA\xbd\xe3\xc4T7G\xdf\x0bC\xa11\xd9\xbd_\xed7jZ]{\xbf\xacx\xfcJ\xce\xc5v\xca3\x1e9\xf4\xd9P\xfe\xdb\xe4\xfe\x0c[_U\x1a\t\xc9\xb3\xbf\xb5\xbf\x94\xa4\x87Y\xe0\xdf\x94I\xd5\xb5\xe9\xf3*\xd7\xadV-.\xba\xd3\xb5\x8c\x05\xc4\xf9\x04:Y\x12\xe3\xdc\x92\xb1\xfe\xb3\xe59\x98\xac\xa1\xa6\x05\xae\xf7|\x06\xa8%\xcc\xca\xc9\xcc\xfa\xc5\xd4YV\xe2\xc69\xd1[{1\x9d\xdc~H\xbdG\xae3\r\xad\xe9=%\xbbh\xabG<\xeaK\xbb\xb8\xf8\xb8\xa1t\xa7\xfaTgd\xb7\xe9WHk|\xb7\xb84\xfe\x0b*\xb2\xc7W\xea\x13.v\xa4\xf9\x9dQC\xdc}T\xe9y\x19\xd8\xee\xcd\xea\x0fs\xa8|\xb6\xba\x8cC\xbc]\xc2\xa5\x98,\xfa\xaf\xd7k\xf4\x0f\xea\x99.\r\xb1\x9f\x9b\x0f0\x1d\x1e \xf2\xb7\xbaoU\xc6\xaf\xa6Q]D\x06\xb6\xb6\x81\xf1\x8dW=\xf5\x9a\xe1\xd4r\xb0\xe9\xafW\x1b\x1a\xd1\xf3s]\xff\x00}I.\xff\x00\xaf\xbc=\xa7\x96:\x16WZ\xac?\x06\xef\xea\x9f\xc1\x1e\x9bwYk\x87\x05\xda|\x84 u{6t\xeb\xec?\xb8\xef\xc5\x059\x9fS\xa4\x0c\x8f\r\xcc\xfc\x85t\xf8\x1f\xa4\xcf\xc6h\xedc\xdd\xfekJ\xe7\xbe\xabU\xe8\xe0Y{\xbf>\xcd>\x0c\x11\xf9WI\xf5z\xb3nG\xacx\xae\xb2~v;\xfb\x9a\x88\xdd\x1d\x1e\x89$\x92OZ\xa5\x0bkm\xb5\xba\xb7p\xe1\ni$\xa7\xcd\xbe\xb5\xf4\xa7b\xf5\x02\xf7{k\xcd n\xec\xdc\x8a\xf5c\xbf\xb4\x02\xcb\xb7\x1c\xe6b\x9a#m\x8c\x97\xd5\xf1\x1fI\x9f%\xe9\xddg\xa4cu\x9c+0\xf24\xde=\xaf\x1c\xb5\xc3V\xb8|\n\xf3\xef\xb3_\x8f\x93oN\xcf\xfd\x16m\x06w\xf6x\xe1\xb6\xb7\xc9\xc3\x94\xd2)p6\xf2\x87un-x\x82\x0c-\x1c\x0c\xb6\x01\xe8]\xab\x1d\xdf\xc0\xab\xbdO\xa5\x1c\xb0\xeb\xa9n\xdc\x86\xff\x009_\x13\xe6\x16\x03\xbdJ^Y` \x8f\x147S\xe8\xdfTCi\xc5\xbe\x96\x90[\xeaolx=\xa3\xfb\x97\x1b\xd6Xi\xeb\x17\x83\xa4\xbc\x95\xab\xf5#\xa9\x11\x9bf\x1b\xdd\xa5\xac\x96O\x8b5\x8f\xb8\xa0\xfdq\xc6\xf4z\x88\xbc\r,\xee\x90SJ\x97\x1f\xb2\xe4\xff\x00Z\x93\xff\x00\x9f\x17A\xf5E\xc0\xb3!\xbd\xf74\xfe\x0b\x9a\xc5~\xf6_Ww\xd5\xb8|k!\xdf\x90\x95\xad\xf5O,W\x9c\xfa\\t\xb5\xba|Z\x92\x83\xd8m\xda\xd5\xcc}jk\xb6V\xfe\xcd\'\xf1]n\xd9o\xc5du|\x0f\xb5P\xea\xc8\xf8|RK\xcbt\x1c\xaaN]\x989\x0e\r\xaf2\xb3V\xe3\xc0t\xcb?\x15W?\xa2\xf5.\x9fk\xaa\xf4\xc9`:\x1f/\x8a\x06n\r\xd8\xf6\x168\x16\xb8\x19\x07\xfb\x8a\xd6\xe9\xdf\\:\xb6\x15m\xa3!\x8c\xcacti\xb4{\x80\xf8\xa4\x84=6\xbe\xad\xb40Mu\xf1\xe2\x7f\xb2\x04\xad\x8a\xf1\x9f\x89h\xbf\'L\x82\xd2\xca*:\xba\xb6\xbb\xe9X\xff\x00\xe5;\xc3\xb2\x8b\xfe\xb6\xf5,\xdff=5\xd0H\x89\xad\x9e\xe8\xfe\xb1E\xc1\xc3\xb9\xee\xf5\xaf%\xcfq\x9duI-\xfcFCCU\x1f\xac\xb68\xd1N\rZ\xd9\x92\xf0\xd0\xd1\xe0\x0f\xf7\xc2\xdb\xa3\x1cT\xc2\xf7\xe9\x02I=\x82\xcb\xc6\xa7\xedY\xaf\xeby\x02+`5\xe1\xb4\xfe\xe8\xe6\xcf\x9fd\x94\x90\xd4\xdc\x1c:p+"`2|I\xfaEu\x1d\x0f\x1b\xd0\xc2\x0f"\x1dq\xdf\xfd\x98\x86\xfe\x01s}/\x1d\xdd_\xa8n?\xcc\xb6D\xff\x00$\x1fq\xf9\xf0\x17h\x00h\x00\x08\x03@\x11\x88ZWI$\x93\x90\xa4\x92I%)d\xf5\xff\x00\xab\xf8\xfdn\x86\x9d\xde\x86]\x12q\xf2Z5a\xfd\xd3\xe2\xd3\xdc-d\x92S\xe7\x0f\x17\xe3d\x0e\x9f\xd5\xd9\xf6L\xc6\xff\x005h\xd6\xbb\x00\xef[\xb8s\x7f\x93\xc8B\xcd\xe9X\xb9\xa22\x9a+\xb4\xe8-o\x07\xe7\xfc\n\xf4<\xee\x9f\x85\xd4\xf1\xce.u-\xbe\xa7~k\x87\x07\xc4\x1eA\xf8.k+\xea\x97Q\xc2\x93\xd22\x1b\x93Gll\xb2w\x01\xe0\xcb\x87\xfd\xf8&\x98\xf6]\xc5\xdd\xe3\x07@\xea\x9d+.\xac\xdc\x13\xea\x9a^\x1e\xd0;\xc7o\x98[\xff\x00Yq\x87S\xe9\x8c\xcb\xa9\xa4\x10\xdd\xdbO#\xc8\xfc\x13\xd8r\xf0$e\xe2d\xe1G.\xd9\xebU\xfeu{\x87\xe0\x89GV\xc2\xb0\x1a.\xca\xc7,p3.\xd8\xe0|\xc3\xa1\x04\xe8\xf0\xd4^q\xeee\x91>\x9b\xa4\xb7\xc4p\xe1\xf3\x05Ym\xae\xe9\xf9\xad\xb6\xa3!\xa4>\xb7~\xf3N\xa3\xef\x08\xff\x00X:K\xf0\xef7\xd27R\xfdA\x1a\x8dV}\x167&\xb1\x88\xf3\x166}\x17\x1e\xf3\xcdd\xfeDP\xfa\x7fI\xce\xab;\x19\x960\xc8p\x9f\x81V\xee\xc6\xdf\xd9y\xafD\xeb\x97\xf4\x8c\x8fJ\xd9\xd8O\xb9\xa7\xb1^\x85\xd3z\xce&mMs\\\x1c\x0f\x9a\ti\xe6t\x8a\xaf\x90\xf6O\xc9g\x7f\xcd\xcc`\xef\xa0\xba\xf0(\xb3\x82\x9f\xec\xf5w))\xe6\xf1\xba5u@c\x03~P\xb5\xb1\xba~\xc2\x0c|\xd5\xe7}\x96\x9d\\F\x8b?\xa8\xf5\xbc\\j\xc9s\x83\x1a<JJ[=\x959\x86\xa7\x18\xa4\x7f8?\x7f\xf9?\x0f\x1f\x15\x81\x97\x97gR\xc9\x1d?\x08\x12$5\xe5\xbe\x7f\x9a\xdf5Z\xfe\xa9\x9b\xd7o\x18\xdd=\xae\x15\xb8\xed\xf5\x00\xd5\xdeL\x0b\xb0\xfa\xbd\xf5~\xae\x91H{\xc07\x91\xaf}\xb3\xce\xbd\xc9\xeeQ\x02\xd0Ko\xa4t\xda\xfaf#j\x00z\x84\x02\xf2?\x06\x8f \xaf\xa4\x92r\xd5$\x92I)I$\x92JRI$\x92\x94\x92I$\xa5!Y\x8b\x8bw\xf3\xd4\xd7g\xf5\xda\x1d\xf9B*I)\xca\xea\xbd\x03\x13\xa8Pkk\x1bY\x02\x00\x02\x1b\x03\xc8p\xbc\xcf\xaf\xfdQ\xcd\xe9\xd6\xb9\xd5\xb0\xec\xd4\xc7\xf7/aP\xb6\x9a\xaea\xae\xd6\x07\xb4\xf2\x1c$!I\xb7\xc2~\xd0\x1e=\x1c\xf6\x90\xe6\xe8-\x02\\#\xf7\x87\x7f\xca\x8f\x8e\xfc\xecS\xea\xe0\xdb\xea4w\xac\xcf\xde9\xfb\xc2\xf5\x1e\xa3\xf5#\xa2\xe7\xcb\x83\r.=\xdb\xa8\xfb\x8a\xc1\xbf\xfcW7~\xecl\xa0\xdf\t\x04\x1f\xc2P\xa5[\x81\x8d\xf5\xcb\xa9c\x80\xdb\x99\xba4\xf0V\xbf\xe7\xd6K\x846\xa2O\x84\xadF\xff\x00\x8b\x8e\xa84\xfd\xa26\xf9\xcb\xbf(Wq\xbf\xc5\xdbZA\xcb\xea\x16\xbcwm`3\xf1J\x93o1w\xd6.\xb9\x94!\x8c\x144\xfes\xf4\xfc\xaa\xe7J\xfa\xad\xd5:\xd3\xdb~Qs\xeb\xe7\xd4\xb6[_\xf6[\xa3\x9c\xbb\x8e\x9f\xf5_\xa2\xf4\xe7\x0b)\xc7\x16Z?\xc2\xdd\xfaG\x7f\xd2Z\xa8\xf0\xa2\xdc\xfe\x95\xd10\xfaMq@\xdddC\xadp\x13\x1e\x00\x0f\xa2<\x82\xd1I$P\xa4\x92I%)$\x92IJI$\x92R\x92I$\x94\xa4\x92I%)$\x92IJI$\x92R\x92I$\x94\xa4\x92I%)$\x92IJI$\x92R\x92I$\x94\xa4\x92I%?\xff\xd9'"


for t in text["blocks"]:
    if t["type"] == 1:
        image = t["image"]
        # Open the image using Pillow
        image_stream = io.BytesIO(image)

        image = Image.open(image_stream)
        # Save the image as JPEG
        image.save("output_image.jpeg", format="JPEG")


# print(text)


# page.set_mediabox(pdf_rect)

# doc.save("results.pdf")


# print(page.get_images()[0][0])


# for pic in page.get_image_rects(6):
#     print(pic)


# Rect(45.35647964477539, -505.07489013671875, 125.73466491699219, -425.3397216796875)

# for info in page.get_images():
#     xref = info[0]
#     pix = pymupdf.Pixmap(doc, xref)

#     # Create a unique filename using the xref
#     filename_xref = f"image_{xref}.png"
#     pix.save(filename_xref)


# page.set_mediabox(default_mediabox)

# Extract the image from the PDF


# info = page.get_images()

# xref = info[0][0]

# pix = pymupdf.Pixmap(doc, xref)

# pix.save("image.png")

# print(xref)

# for info in page.get_image_info():
#     xref = info[0]
#     img = doc.extractImage(xref)
#     ext, data = img["ext"], img["image"]

#     with open(f"/{xref}.{ext}", "wb") as f:
#         f.write(data)


# # Optionally, draw the rectangle on the PDF (uncomment if needed)
# rect_color = (1, 0, 0)  # Red color in RGB
# page.draw_rect(pdf_rect, color=rect_color, width=1)

# # Save the modified PDF
# doc.save(output_pdf_path)

# # Close the document
# doc.close()
